# Template file for 'esconf'
pkgname=esconf
version=0.1.0
revision=1
build_helper=gir
build_style=gnu-configure
wrksrc="esconf-master"
configure_args="--with-locales-dir=/usr/share/locale --enable-gsettings-backend"
hostmakedepends="pkg-config intltool glib-devel vala-devel xfce4-dev-tools gettext-devel"
makedepends="libexpidus1util-devel vala-devel"
checkdepends="dbus xvfb-run"
short_desc="ExpidusOS Shell hierarchical (tree-like) configuration system"
maintainer="Tristan Ross <rosscomputerguy@protonmail.com>"
license="GPL-2.0-only, LGPL-2.0-only"
homepage="http://expidusos.com"
distfiles="https://github.com/ExpidusOS/esconf/archive/master.tar.gz"
checksum=147b2278c92d764d81564b5b2eaa81f01552bcf721c37a7e829a1764346f3dbe
build_options="gir"
build_options_default="gir"

do_configure() {
	./autogen.sh ${configure_args} --enable-gtk-doc
}

do_check() {
	dbus-run-session xvfb-run make check
}

esconf-devel_package() {
	depends="dbus-glib-devel ${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/*.so
		vmove usr/lib/pkgconfig
		vmove usr/share/gtk-doc
		if [ "$build_option_gir" ]; then
			vmove usr/share/vala
			vmove usr/share/gir-1.0
		fi
	}
}
